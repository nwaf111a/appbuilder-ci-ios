version: 2.1
orbs:
  aws-s3: circleci/aws-s3@1.0.15
  
jobs:
  build:
    macos:
      xcode: "11.1.0"
    steps:
      - checkout
      - run: mkdir -p appbuilder/secrets
      - aws-s3/sync:
          from: "${APPBUILDER_SECRETS_PATH}"
          to: appbuilder/secrets
      - run: mkdir -p asset
      - aws-s3/sync:
          from: "${APPBUILDER_ASSET_DOWNLOAD_PATH}"
          to: asset
      - run: ./resign_asset.sh
      - aws-s3/sync:
          from: result
          to: "${APPBUILDER_ASSET_RESULT_PATH}"
